"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setSecret = exports.parseSecretName = exports.hasSecret = exports.getWildcardARN = exports.getSecretReference = exports.getSecretARN = exports.getSecret = exports.deleteSecret = void 0;
var _clientSecretsManager = require("@aws-sdk/client-secrets-manager");
var __getSecret, _createSecret, _deleteSecret, _getSecret, _updateSecret, deleteSecret, getSecret, getSecretARN, getSecretReference, getWildcardARN, hasSecret, manager, parseSecretName, region, secrets, setSecret;
exports.setSecret = setSecret;
exports.parseSecretName = parseSecretName;
exports.hasSecret = hasSecret;
exports.getWildcardARN = getWildcardARN;
exports.getSecretReference = getSecretReference;
exports.getSecretARN = getSecretARN;
exports.getSecret = getSecret;
exports.deleteSecret = deleteSecret;
region = "us-east-1";
manager = new _clientSecretsManager.SecretsManager({
  region
});
secrets = {};
exports.parseSecretName = parseSecretName = function (name) {
  if (name == null) {
    return [];
  }
  return name.split("/");
};
exports.hasSecret = hasSecret = async function (_name) {
  var error, name;
  [name] = parseSecretName(_name);
  try {
    await manager.describeSecret({
      SecretId: name
    });
    return true;
  } catch (error1) {
    error = error1;
    if (/ResourceNotFoundException/.test(error.toString())) {
      return false;
    } else {
      throw error;
    }
  }
};
__getSecret = async function (_name) {
  var _error, bundle, error, name, secret, subName;
  [name, subName] = parseSecretName(_name);
  secret = await manager.getSecretValue({
    SecretId: name
  });
  if (subName != null) {
    secret = {
      ...secret
    };
    try {
      bundle = JSON.parse(secret.SecretString);
    } catch (error1) {
      _error = error1;
      error = new Error(`Unable to parse JSON for secrets bundle [ ${name} ], using reference [ ${_name} ]`);
      error._error = _error;
      throw error;
    }
    secret.SecretString = bundle != null ? bundle[subName] : void 0;
  }
  return secret;
};

// TODO replace this primitive expiry mechanism with a means to message lambdas?
// and/or we can use worker message queues...
_getSecret = async function (name) {
  var secret;
  if ((secret = secrets[name]) == null || Date.now() > secret.expires) {
    secret = {
      value: await __getSecret(name),
      expires: Date.now() + 60000
    };
    secrets[name] = secret;
  }
  return secret.value;
};
exports.getSecret = getSecret = async function (name) {
  var SecretString;
  ({
    SecretString
  } = await _getSecret(name));
  return SecretString;
};
exports.getSecretARN = getSecretARN = async function (name) {
  var ARN;
  ({
    ARN
  } = await _getSecret(name));
  return ARN;
};
exports.getWildcardARN = getWildcardARN = function (name) {
  return `arn:aws:secretsmanager:${region}:*:secret:${name}`;
};
exports.getSecretReference = getSecretReference = async function (name) {
  var VersionId;
  ({
    VersionId
  } = await _getSecret(name));
  return `{{resolve:secretsmanager:${name}:SecretString:::${VersionId}}}`;
};
_updateSecret = async function (_name, _value) {
  var name, subName, value;
  [name, subName] = parseSecretName(_name);
  if (subName != null) {
    value = JSON.parse(await getSecret(name));
    value[subName] = _value;
    value = JSON.stringify(value);
    return await manager.updateSecret({
      SecretId: name,
      SecretString: value
    });
  } else {
    return await manager.updateSecret({
      SecretId: name,
      SecretString: _value
    });
  }
};
_createSecret = async function (_name, _value) {
  var name, subName, value;
  [name, subName] = parseSecretName(_name);
  if (subName != null) {
    value = JSON.stringify({
      [subName]: _value
    });
    return await manager.createSecret({
      Name: name,
      SecretString: value
    });
  } else {
    return await manager.createSecret({
      Name: name,
      SecretString: _value
    });
  }
};
exports.setSecret = setSecret = async function (name, value) {
  var _value;
  if (await hasSecret(name)) {
    _value = await _updateSecret(name, value);
  } else {
    _value = await _createSecret(name, value);
  }
  return secrets[name] = {
    value: _value,
    expires: Date.now() + 60000
  };
};
_deleteSecret = async function (_name) {
  var name, subName, value;
  [name, subName] = parseSecretName(_name);
  if (subName != null) {
    value = JSON.parse(await getSecret(name));
    delete value[subName];
    value = JSON.stringify(value);
    return await setSecret(name, value);
  } else {
    return await manager.deleteSecret({
      SecretId: name,
      ForceDeleteWithoutRecovery: true
    });
  }
};
exports.deleteSecret = deleteSecret = async function (name) {
  await _deleteSecret(name);
  return delete secrets[name];
};
//# sourceMappingURL=data:application/json;base64,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QUFkLENBQUE7U0FDTixPQUFPLE9BQU8sQ0FBRSxJQUFGLENBQUE7QUFGRCxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2VjcmV0c01hbmFnZXIgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LXNlY3JldHMtbWFuYWdlclwiXG5cbnJlZ2lvbiA9ICBcInVzLWVhc3QtMVwiXG5tYW5hZ2VyID0gbmV3IFNlY3JldHNNYW5hZ2VyIHsgcmVnaW9uIH1cbnNlY3JldHMgPSB7fVxuXG5wYXJzZVNlY3JldE5hbWUgPSAobmFtZSkgLT5cbiAgcmV0dXJuIFtdIGlmICFuYW1lP1xuICBuYW1lLnNwbGl0IFwiL1wiXG5cbmhhc1NlY3JldCA9IChfbmFtZSkgLT5cbiAgWyBuYW1lIF0gPSBwYXJzZVNlY3JldE5hbWUgX25hbWVcblxuICB0cnlcbiAgICBhd2FpdCBtYW5hZ2VyLmRlc2NyaWJlU2VjcmV0IFNlY3JldElkOiBuYW1lXG4gICAgdHJ1ZVxuICBjYXRjaCBlcnJvclxuICAgIGlmIC9SZXNvdXJjZU5vdEZvdW5kRXhjZXB0aW9uLy50ZXN0IGVycm9yLnRvU3RyaW5nKClcbiAgICAgIGZhbHNlXG4gICAgZWxzZVxuICAgICAgdGhyb3cgZXJyb3JcblxuX19nZXRTZWNyZXQgPSAoX25hbWUpIC0+XG4gIFsgbmFtZSwgc3ViTmFtZSBdID0gcGFyc2VTZWNyZXROYW1lIF9uYW1lXG4gIHNlY3JldCA9IGF3YWl0IG1hbmFnZXIuZ2V0U2VjcmV0VmFsdWUgU2VjcmV0SWQ6IG5hbWVcbiAgaWYgc3ViTmFtZT8gXG4gICAgc2VjcmV0ID0geyBzZWNyZXQuLi4gfVxuICAgIHRyeVxuICAgICAgYnVuZGxlID0gSlNPTi5wYXJzZSBzZWNyZXQuU2VjcmV0U3RyaW5nXG4gICAgY2F0Y2ggX2Vycm9yXG4gICAgICBlcnJvciA9IG5ldyBFcnJvciBcIlVuYWJsZSB0byBwYXJzZSBKU09OIGZvciBzZWNyZXRzIGJ1bmRsZSBbICN7bmFtZX0gXSxcbiAgICAgICAgdXNpbmcgcmVmZXJlbmNlIFsgI3tfbmFtZX0gXVwiXG4gICAgICBlcnJvci5fZXJyb3IgPSBfZXJyb3JcbiAgICAgIHRocm93IGVycm9yXG4gICAgc2VjcmV0LlNlY3JldFN0cmluZyA9IGJ1bmRsZT9bc3ViTmFtZV1cbiAgc2VjcmV0XG5cbiMgVE9ETyByZXBsYWNlIHRoaXMgcHJpbWl0aXZlIGV4cGlyeSBtZWNoYW5pc20gd2l0aCBhIG1lYW5zIHRvIG1lc3NhZ2UgbGFtYmRhcz9cbiMgYW5kL29yIHdlIGNhbiB1c2Ugd29ya2VyIG1lc3NhZ2UgcXVldWVzLi4uXG5fZ2V0U2VjcmV0ID0gKG5hbWUpIC0+XG4gIGlmICEoIHNlY3JldCA9IHNlY3JldHNbbmFtZV0gKT8gfHwgKCBEYXRlLm5vdygpID4gc2VjcmV0LmV4cGlyZXMgKVxuICAgIHNlY3JldCA9XG4gICAgICB2YWx1ZTogYXdhaXQgX19nZXRTZWNyZXQgbmFtZVxuICAgICAgZXhwaXJlczogRGF0ZS5ub3coKSArIDYwMDAwXG4gICAgc2VjcmV0c1sgbmFtZSBdID0gc2VjcmV0XG4gIHNlY3JldC52YWx1ZVxuXG5nZXRTZWNyZXQgPSAobmFtZSkgLT5cbiAgeyBTZWNyZXRTdHJpbmcgfSA9IGF3YWl0IF9nZXRTZWNyZXQgbmFtZVxuICBTZWNyZXRTdHJpbmdcblxuZ2V0U2VjcmV0QVJOID0gKG5hbWUpIC0+XG4gIHsgQVJOIH0gPSBhd2FpdCBfZ2V0U2VjcmV0IG5hbWVcbiAgQVJOXG5cbmdldFdpbGRjYXJkQVJOID0gKG5hbWUpIC0+IFxuICBcImFybjphd3M6c2VjcmV0c21hbmFnZXI6I3tyZWdpb259Oio6c2VjcmV0OiN7bmFtZX1cIlxuXG5nZXRTZWNyZXRSZWZlcmVuY2UgPSAobmFtZSkgLT5cbiAgeyBWZXJzaW9uSWQgfSA9IGF3YWl0IF9nZXRTZWNyZXQgbmFtZVxuICBcInt7cmVzb2x2ZTpzZWNyZXRzbWFuYWdlcjoje25hbWV9OlNlY3JldFN0cmluZzo6OiN7VmVyc2lvbklkfX19XCJcblxuX3VwZGF0ZVNlY3JldCA9IChfbmFtZSwgX3ZhbHVlKSAtPlxuICBbIG5hbWUsIHN1Yk5hbWUgXSA9IHBhcnNlU2VjcmV0TmFtZSBfbmFtZVxuICBpZiBzdWJOYW1lP1xuICAgIHZhbHVlID0gSlNPTi5wYXJzZSBhd2FpdCBnZXRTZWNyZXQgbmFtZVxuICAgIHZhbHVlWyBzdWJOYW1lIF0gPSBfdmFsdWVcbiAgICB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5IHZhbHVlXG4gICAgYXdhaXQgbWFuYWdlci51cGRhdGVTZWNyZXQgU2VjcmV0SWQ6IG5hbWUsIFNlY3JldFN0cmluZzogdmFsdWVcbiAgZWxzZVxuICAgIGF3YWl0IG1hbmFnZXIudXBkYXRlU2VjcmV0IFNlY3JldElkOiBuYW1lLCBTZWNyZXRTdHJpbmc6IF92YWx1ZVxuXG5fY3JlYXRlU2VjcmV0ID0gKF9uYW1lLCBfdmFsdWUpIC0+XG4gIFsgbmFtZSwgc3ViTmFtZSBdID0gcGFyc2VTZWNyZXROYW1lIF9uYW1lXG4gIGlmIHN1Yk5hbWU/XG4gICAgdmFsdWUgPSBKU09OLnN0cmluZ2lmeSBbIHN1Yk5hbWUgXTogX3ZhbHVlXG4gICAgYXdhaXQgbWFuYWdlci5jcmVhdGVTZWNyZXQgTmFtZTogbmFtZSwgU2VjcmV0U3RyaW5nOiB2YWx1ZVxuICBlbHNlXG4gICAgYXdhaXQgbWFuYWdlci5jcmVhdGVTZWNyZXQgTmFtZTogbmFtZSwgU2VjcmV0U3RyaW5nOiBfdmFsdWVcblxuc2V0U2VjcmV0ID0gKG5hbWUsIHZhbHVlKSAtPlxuICBpZiBhd2FpdCBoYXNTZWNyZXQgbmFtZVxuICAgIF92YWx1ZSA9IGF3YWl0IF91cGRhdGVTZWNyZXQgbmFtZSwgdmFsdWVcbiAgZWxzZVxuICAgIF92YWx1ZSA9IGF3YWl0IF9jcmVhdGVTZWNyZXQgbmFtZSwgdmFsdWVcbiAgXG4gIHNlY3JldHNbbmFtZV0gPSBcbiAgICB2YWx1ZTogX3ZhbHVlXG4gICAgZXhwaXJlczogRGF0ZS5ub3coKSArIDYwMDAwXG5cbl9kZWxldGVTZWNyZXQgPSAoX25hbWUpIC0+XG4gIFsgbmFtZSwgc3ViTmFtZSBdID0gcGFyc2VTZWNyZXROYW1lIF9uYW1lXG4gIGlmIHN1Yk5hbWU/XG4gICAgdmFsdWUgPSBKU09OLnBhcnNlIGF3YWl0IGdldFNlY3JldCBuYW1lXG4gICAgZGVsZXRlIHZhbHVlWyBzdWJOYW1lIF1cbiAgICB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5IHZhbHVlXG4gICAgYXdhaXQgc2V0U2VjcmV0IG5hbWUsIHZhbHVlXG4gIGVsc2VcbiAgICBhd2FpdCBtYW5hZ2VyLmRlbGV0ZVNlY3JldFxuICAgICAgU2VjcmV0SWQ6IG5hbWVcbiAgICAgIEZvcmNlRGVsZXRlV2l0aG91dFJlY292ZXJ5OiB0cnVlXG5cbmRlbGV0ZVNlY3JldCA9IChuYW1lKSAtPlxuICBhd2FpdCBfZGVsZXRlU2VjcmV0IG5hbWVcbiAgZGVsZXRlIHNlY3JldHNbIG5hbWUgXVxuXG5leHBvcnQge1xuICBwYXJzZVNlY3JldE5hbWVcbiAgaGFzU2VjcmV0XG4gIGdldFNlY3JldFxuICBnZXRTZWNyZXRBUk5cbiAgZ2V0V2lsZGNhcmRBUk5cbiAgZ2V0U2VjcmV0UmVmZXJlbmNlXG4gIHNldFNlY3JldFxuICBkZWxldGVTZWNyZXRcbn0iXSwic291cmNlUm9vdCI6IiJ9
//# sourceURL=src/secrets.coffee